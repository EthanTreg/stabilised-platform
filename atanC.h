int16_t atanTable[1025] = {
	0, 12, 25, 37, 50, 62, 75, 87, 100, 113, 125, 138, 150, 163, 175, 188,
	201, 213, 226, 238, 251, 263, 276, 289, 301, 314, 326, 339, 351, 364, 377, 389,
	402, 414, 427, 439, 452, 465, 477, 490, 502, 515, 527, 540, 553, 565, 578, 590,
	603, 616, 628, 641, 653, 666, 678, 691, 704, 716, 729, 741, 754, 767, 779, 792,
	804, 817, 830, 842, 855, 867, 880, 893, 905, 918, 930, 943, 956, 968, 981, 993,
	1006, 1019, 1031, 1044, 1057, 1069, 1082, 1094, 1107, 1120, 1132, 1145, 1158, 1170, 1183, 1195,
	1208, 1221, 1233, 1246, 1259, 1271, 1284, 1297, 1309, 1322, 1334, 1347, 1360, 1372, 1385, 1398,
	1410, 1423, 1436, 1448, 1461, 1474, 1486, 1499, 1512, 1524, 1537, 1550, 1562, 1575, 1588, 1600,
	1613, 1626, 1639, 1651, 1664, 1677, 1689, 1702, 1715, 1727, 1740, 1753, 1766, 1778, 1791, 1804,
	1816, 1829, 1842, 1855, 1867, 1880, 1893, 1906, 1918, 1931, 1944, 1957, 1969, 1982, 1995, 2008,
	2020, 2033, 2046, 2059, 2071, 2084, 2097, 2110, 2122, 2135, 2148, 2161, 2174, 2186, 2199, 2212,
	2225, 2238, 2250, 2263, 2276, 2289, 2302, 2314, 2327, 2340, 2353, 2366, 2378, 2391, 2404, 2417,
	2430, 2443, 2456, 2468, 2481, 2494, 2507, 2520, 2533, 2546, 2558, 2571, 2584, 2597, 2610, 2623,
	2636, 2649, 2661, 2674, 2687, 2700, 2713, 2726, 2739, 2752, 2765, 2778, 2791, 2804, 2817, 2829,
	2842, 2855, 2868, 2881, 2894, 2907, 2920, 2933, 2946, 2959, 2972, 2985, 2998, 3011, 3024, 3037,
	3050, 3063, 3076, 3089, 3102, 3115, 3128, 3141, 3154, 3167, 3180, 3193, 3206, 3219, 3232, 3245,
	3258, 3272, 3285, 3298, 3311, 3324, 3337, 3350, 3363, 3376, 3389, 3402, 3416, 3429, 3442, 3455,
	3468, 3481, 3494, 3507, 3521, 3534, 3547, 3560, 3573, 3586, 3600, 3613, 3626, 3639, 3652, 3665,
	3679, 3692, 3705, 3718, 3731, 3745, 3758, 3771, 3784, 3798, 3811, 3824, 3837, 3851, 3864, 3877,
	3890, 3904, 3917, 3930, 3944, 3957, 3970, 3983, 3997, 4010, 4023, 4037, 4050, 4063, 4077, 4090,
	4103, 4117, 4130, 4144, 4157, 4170, 4184, 4197, 4210, 4224, 4237, 4251, 4264, 4278, 4291, 4304,
	4318, 4331, 4345, 4358, 4372, 4385, 4399, 4412, 4426, 4439, 4452, 4466, 4479, 4493, 4507, 4520,
	4534, 4547, 4561, 4574, 4588, 4601, 4615, 4628, 4642, 4656, 4669, 4683, 4696, 4710, 4724, 4737,
	4751, 4764, 4778, 4792, 4805, 4819, 4833, 4846, 4860, 4874, 4887, 4901, 4915, 4928, 4942, 4956,
	4970, 4983, 4997, 5011, 5024, 5038, 5052, 5066, 5080, 5093, 5107, 5121, 5135, 5148, 5162, 5176,
	5190, 5204, 5218, 5231, 5245, 5259, 5273, 5287, 5301, 5315, 5329, 5342, 5356, 5370, 5384, 5398,
	5412, 5426, 5440, 5454, 5468, 5482, 5496, 5510, 5524, 5538, 5552, 5566, 5580, 5594, 5608, 5622,
	5636, 5650, 5664, 5678, 5692, 5706, 5720, 5735, 5749, 5763, 5777, 5791, 5805, 5819, 5833, 5848,
	5862, 5876, 5890, 5904, 5919, 5933, 5947, 5961, 5975, 5990, 6004, 6018, 6032, 6047, 6061, 6075,
	6090, 6104, 6118, 6133, 6147, 6161, 6176, 6190, 6204, 6219, 6233, 6247, 6262, 6276, 6291, 6305,
	6320, 6334, 6348, 6363, 6377, 6392, 6406, 6421, 6435, 6450, 6464, 6479, 6493, 6508, 6522, 6537,
	6552, 6566, 6581, 6595, 6610, 6625, 6639, 6654, 6668, 6683, 6698, 6712, 6727, 6742, 6757, 6771,
	6786, 6801, 6815, 6830, 6845, 6860, 6874, 6889, 6904, 6919, 6934, 6948, 6963, 6978, 6993, 7008,
	7023, 7038, 7053, 7067, 7082, 7097, 7112, 7127, 7142, 7157, 7172, 7187, 7202, 7217, 7232, 7247,
	7262, 7277, 7292, 7307, 7322, 7337, 7352, 7368, 7383, 7398, 7413, 7428, 7443, 7458, 7474, 7489,
	7504, 7519, 7534, 7550, 7565, 7580, 7595, 7611, 7626, 7641, 7656, 7672, 7687, 7702, 7718, 7733,
	7749, 7764, 7779, 7795, 7810, 7826, 7841, 7856, 7872, 7887, 7903, 7918, 7934, 7949, 7965, 7980,
	7996, 8012, 8027, 8043, 8058, 8074, 8090, 8105, 8121, 8137, 8152, 8168, 8184, 8199, 8215, 8231,
	8247, 8262, 8278, 8294, 8310, 8325, 8341, 8357, 8373, 8389, 8405, 8421, 8436, 8452, 8468, 8484,
	8500, 8516, 8532, 8548, 8564, 8580, 8596, 8612, 8628, 8644, 8660, 8676, 8692, 8709, 8725, 8741,
	8757, 8773, 8789, 8805, 8822, 8838, 8854, 8870, 8887, 8903, 8919, 8935, 8952, 8968, 8984, 9001,
	9017, 9034, 9050, 9066, 9083, 9099, 9116, 9132, 9149, 9165, 9182, 9198, 9215, 9231, 9248, 9264,
	9281, 9298, 9314, 9331, 9347, 9364, 9381, 9397, 9414, 9431, 9448, 9464, 9481, 9498, 9515, 9532,
	9548, 9565, 9582, 9599, 9616, 9633, 9650, 9667, 9684, 9701, 9717, 9734, 9751, 9769, 9786, 9803,
	9820, 9837, 9854, 9871, 9888, 9905, 9922, 9940, 9957, 9974, 9991, 10009, 10026, 10043, 10060, 10078,
	10095, 10112, 10130, 10147, 10165, 10182, 10199, 10217, 10234, 10252, 10269, 10287, 10304, 10322, 10339, 10357,
	10375, 10392, 10410, 10427, 10445, 10463, 10480, 10498, 10516, 10534, 10551, 10569, 10587, 10605, 10623, 10641,
	10658, 10676, 10694, 10712, 10730, 10748, 10766, 10784, 10802, 10820, 10838, 10856, 10874, 10892, 10911, 10929,
	10947, 10965, 10983, 11002, 11020, 11038, 11056, 11075, 11093, 11111, 11130, 11148, 11166, 11185, 11203, 11222,
	11240, 11259, 11277, 11296, 11314, 11333, 11351, 11370, 11389, 11407, 11426, 11445, 11463, 11482, 11501, 11520,
	11538, 11557, 11576, 11595, 11614, 11633, 11652, 11671, 11689, 11708, 11727, 11746, 11765, 11785, 11804, 11823,
	11842, 11861, 11880, 11899, 11919, 11938, 11957, 11976, 11996, 12015, 12034, 12054, 12073, 12092, 12112, 12131,
	12151, 12170, 12190, 12209, 12229, 12248, 12268, 12288, 12307, 12327, 12347, 12366, 12386, 12406, 12426, 12445,
	12465, 12485, 12505, 12525, 12545, 12565, 12585, 12605, 12625, 12645, 12665, 12685, 12705, 12725, 12745, 12765,
	12786, 12806, 12826, 12846, 12867, 12887, 12907, 12928, 12948, 12969, 12989, 13010, 13030, 13051, 13071, 13092,
	13112, 13133, 13154, 13174, 13195, 13216, 13237, 13257, 13278, 13299, 13320, 13341, 13362, 13383, 13403, 13424,
	13446, 13467, 13488, 13509, 13530, 13551, 13572, 13593, 13615, 13636, 13657, 13678, 13700, 13721, 13743, 13764,
	13785, 13807, 13828, 13850, 13871, 13893, 13915, 13936, 13958, 13980, 14001, 14023, 14045, 14067, 14089, 14111,
	14132, 14154, 14176, 14198, 14220, 14242, 14264, 14287, 14309, 14331, 14353, 14375, 14398, 14420, 14442, 14464,
	14487, 14509, 14532, 14554, 14577, 14599, 14622, 14644, 14667, 14690, 14712, 14735, 14758, 14781, 14803, 14826,
	14849, 14872, 14895, 14918, 14941, 14964, 14987, 15010, 15033, 15056, 15080, 15103, 15126, 15149, 15173, 15196,
	15219, 15243, 15266, 15290, 15313, 15337, 15361, 15384, 15408, 15432, 15455, 15479, 15503, 15527, 15551, 15574,
	15598, 15622, 15646, 15670, 15694, 15719, 15743, 15767, 15791, 15815, 15840, 15864, 15888, 15913, 15937, 15962,
	15986, 16011, 16035, 16060, 16085, 16109, 16134, 16159, 16184, 16209, 16233, 16258, 16283, 16308, 16333, 16358,
	16384};

int16_t partal(int16_t a,int16_t b,int16_t x){//work out the 2bit extra using reverse linear interpolation
	int16_t inc = b-a;
	int16_t tot=inc;
	int16_t dif = (x-a)<<2;
	if(tot>dif)return 0;
	tot+=inc;
	if(tot>dif)return 1;
	tot+=inc;
	if(tot>dif)return 2;
	return 3;
}

int16_t atanC(int16_t x, int16_t y){
	int32_t div = ((int32_t)x<<14)/(int32_t)y;//fixed point divide
	if(div>16384)return -1;//x must be smaller than y (this only does the first octant)
	if(div<0)return -1;
	int top = 1024;
	int botom = 0;
	while(1){//binary search for the division result
		int search = (top+botom)/2;
		if(atanTable[search]>div){
			top = search;
		}else{
			botom = search;
		}
		if(botom+1==top)break;//if theres an interval of one then exit search
	}
	return (bottom<<2)|partal(atanTable[botom],atanTable[top],div);//last 2bits are estimated but rest are lookup
}